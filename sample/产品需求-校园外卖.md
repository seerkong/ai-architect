# 产品需求-校园外卖

校园外卖系统需求文档

一、 系统角色补充
在原角色（用户、超级管理员、店铺管理员）基础上，明确新增角色：
外卖员 (Delivery Personnel)
归属关系：隶属于一个或多个店铺（允许兼职），由店铺管理员进行添加和管理。
核心权限：处理所属店铺的订单，查看个人信息，进行状态管理（上线/下线/请假）。

二、 功能需求详细补充

后台功能增强（店铺管理员视角）
外卖员管理模块
添加外卖员：店铺管理员可录入外卖员信息，必填项包括：姓名、手机号（作为登录账号）、初始密码（或支持短信验证码登录）、与店铺的归属关系。
信息管理：可修改外卖员信息（如姓名）、重置其登录密码、查看其近期活跃度（如完成订单数）。
状态查看：可查看名下所有外卖员的当前状态（如：在线接单、配送中、下线、请假中）。
关系解除：可将外卖员从本店铺名单中移除，移除前需完成所有已指派订单。

新增：外卖员专属平台（Web端或独立小程序/APP）
登录/登出
支持手机号+密码登录。
支持手机号+短信验证码登录，更符合外卖员移动办公场景。
首次登录需强制修改初始密码。

首页/工作台
状态切换开关：显眼的【上线接单】/【下线休息】按钮，状态实时同步至后台。
关键数据卡片：显示今日已完成订单数、预计收入、当前等级等激励信息。
新订单提醒：系统通过WebSocket或高频率短轮询向在线的外卖员推送新订单提醒（发出声音或震动提示），外卖员可进行“抢单”或由系统自动派单。

订单管理
待处理订单：展示已指派给自己的、待取餐的订单列表。包含：订单号、店铺地址、用户地址、预计报酬、期望送达时间。
配送中订单：展示正在配送的订单。核心功能包括：
【联系顾客】/ 【联系商家】：一键拨号，隐藏真实号码以保护隐私。
【导航】：集成地图API（如高德、腾讯地图），一键跳转导航。
【完成送达】：确认订单已完成，需用户签字或输入验证码确认（防纠纷）。
历史订单：支持按日、周、月查询已完成的所有订单记录及详情。

个人中心
我的信息：查看个人资料、累计完成单量、评级、总收入等。
请假申请：可发起请假申请，需选择请假类型（事假、病假等）、开始时间、结束时间、请假缘由。
提交后申请状态为【审批中】，店铺管理员可在后台处理（批准/驳回）。
可查看请假申请的历史记录和审批状态。
消息通知：接收系统通知，如：新版本发布、订单超时提醒、请假审批结果、平台公告等。

三、 系统性能与安全补充
并发处理：系统需能应对午晚餐高峰期的高并发订单创建和派发，确保系统不崩溃、响应迅速。
实时性：订单状态（从商家接单->外卖员取货->送达）的变更需要实时同步给用户、商家和外卖员三方。
数据一致性：通过事务确保关键流程（如抢单、完成订单）的数据一致性，避免超卖、重复派单等问题。
外卖员端性能：考虑到外卖员多使用移动网络，其专属端的接口应尽可能轻量，图片等进行压缩，减少流量消耗。
隐私保护：对所有涉及用户、外卖员手机号等敏感信息的地方进行脱敏显示（如 138****1234），通话采用中间号机制。

四、 非功能性需求补充
可靠性：系统核心功能（下单、支付、派单）的可用性应达到99.9%。
具备灾备方案，在服务器故障时能快速切换。

可扩展性：架构设计应支持未来轻松扩展新功能，如：骑手等级体系、智能派单算法、多平台小程序接入等。
数据库设计应能支撑未来一到两年的业务增长数据量。

易用性：用户端：订餐流程清晰，支付步骤简单。
管理后台：功能模块划分清晰，操作便捷，数据可视化（图表展示销售数据、订单趋势）。
外卖员端：界面极度简化，核心功能（接单、导航、完成）突出，操作步骤少，字体大小适中。

五、 业务流程补充（外卖员相关）
派单流程：
模式一（抢单）：系统向所有“在线”状态的外卖员广播新订单，外卖员自主抢单。
模式二（派单）：系统根据算法（距离最近、评分最高、当前负担最轻等）自动将订单指派给最优的外卖员。
建议：可由店铺管理员在后台选择适合自己店铺的模式。

请假审批流程：
外卖员提交请假申请 -> 系统通知对应店铺管理员 -> 管理员后台审核（批准/驳回） -> 系统通知外卖员结果 -> （若批准）系统自动将该外卖员在此期间设置为“请假”状态，不参与派单。

